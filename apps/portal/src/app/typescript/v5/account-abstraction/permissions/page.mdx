import { Tabs, TabsList, TabsTrigger, TabsContent } from "@/components/ui/tabs";
import { createMetadata } from "@doc";

export const metadata = createMetadata({
	image: {
		title: "Permisos de Cuenta y Claves de Sesión",
		icon: "thirdweb",
	},
	title: "Permisos de Cuenta y Claves de Sesión | thirdweb",
	description:
		"Todos los contratos de cuenta - Simple y Administrada - comparten el mismo modelo de permisos. En esta sección, describiremos este modelo en detalle.",
});

# Permisos de Cuenta y Claves de Sesión

Todos los contratos de cuenta - [Simple](https://thirdweb.com/thirdweb.eth/AccountFactory) y [Administrada](https://thirdweb.com/thirdweb.eth/ManagedAccountFactory) - comparten el mismo modelo de permisos. En esta sección, describiremos este modelo en detalle.

Una cuenta reconoce solo dos tipos de actores: _Claves de Sesión_ y _Administradores_.

## 1. Administradores

Los administradores tienen **acceso sin restricciones** a la cuenta; pueden llamar a cualquier función en el contrato, usar el contrato sin pasar por la infraestructura de ERC-4337 (bundlers, EntryPoint, etc.), retirar el saldo de tokens nativos de la cuenta, entre otras acciones.

### Asignación de Permisos de Administrador

Los administradores existentes en la cuenta pueden agregar nuevos administradores, eliminar administradores existentes o renunciar a su estado de administrador.


```typescript
import { addAdmin } from "thirdweb/extensions/erc4337";
import { smartWallet } from "thirdweb/wallets";
import { sendTransaction, getContract } from "thirdweb";

const smartWallet = new smartWallet(config);
const smartAccount = await smartWallet.connect({
	client,
	personalAccount,
});

const transaction = addAdmin({
	contract: getContract({
		address: smartAccount.address,
		chain,
		client,
	}),
	account: smartAccount,
	adminAddress: "0x...", // the address of the new admin
});
await sendTransaction({
	transaction,
	account: smartAccount,
});
```

## 2. Claves de Sesión

Las claves de sesión son firmantes adicionales autorizados que deben pasar por la infraestructura de ERC-4337 (bundlers, EntryPoint, etc.) para usar una cuenta y ejecutar transacciones. Las claves de sesión pueden utilizar una cuenta bajo ciertas restricciones.

### Asignación de Permisos a las Claves de Sesión

Cada clave de sesión individual tiene sus propios permisos para usar la cuenta. Solo los administradores pueden establecer los permisos para las claves de sesión.

Las claves de sesión pueden asignarse con los siguientes permisos:

- [Obligatorio] Permitir la interacción con contratos específicos usando la cuenta ("*" para cualquier contrato).
- [Opcional] Definir un monto máximo de tokens nativos que se pueden transferir por transacción (por defecto es 0 ETH, por lo que las transacciones con valor serán rechazadas).
- [Opcional] Restringir el acceso a la cuenta a un período de tiempo específico (por defecto es 10 años a partir de ahora).

```ts
import { addAdmin } from "thirdweb/extensions/erc4337";
import { smartWallet } from "thirdweb/wallets";
import { sendTransaction, getContract } from "thirdweb";

const smartWallet = new smartWallet(config);
const smartAccount = await smartWallet.connect({
	client,
	personalAccount,
});

const transaction = addSessionKey({
	contract: getContract({
		address: smartAccount.address,
		chain,
		client,
	}),
	account: smartAccount,
	sessionKeyAddress: "0x...", // la dirección de la nueva clave de sesión
	permissions: {
		approvedTargets: "*", // las direcciones de los contratos permitidos, o '*' para cualquier contrato
		nativeTokenLimitPerTransaction: 0.1, // la cantidad máxima de tokens nativos (en ETH) que la clave de sesión puede gastar por transacción
		permissionStartTimestamp: new Date(), // la fecha en que la clave de sesión se activa
		permissionEndTimestamp: new Date(Date.now() + 24 * 60 * 60 * 1000), // la fecha en que la clave de sesión expira
	},
});
await sendTransaction({
	transaction,
	account: smartAccount,
});
```
