import {
	OpenSourceCard,
	ArticleIconCard,
	InstallTabs,
	Stack,
	createMetadata,
	Callout,
	Tabs,
	TabsContent,
	TabsList,
	TabsTrigger,
} from "@doc";
import next from "@/icons/frameworks/nextjs.png";
import express from "@/icons/frameworks/javascript.png";
import react from "@/icons/frameworks/react.png";
import { GraduationCap } from "lucide-react";

export const metadata = createMetadata({
	image: {
		title: "thirdweb Auth",
		icon: "wallets",
	},
	title: "thirdweb Auth",
	description:
		"Auth allows anyone to integrate passwordless web3-native authentication and authorization into their applications.",
});

# Visión General

Auth permite a cualquiera integrar autenticación y autorización web3-nativa sin contraseña en sus aplicaciones. Los usuarios pueden entonces **iniciar sesión usando cualquier billetera thirdweb** (in-app, navegador o billetera inteligente).

Esto permite a los desarrolladores crear un flujo de autenticación familiar y seguro que funciona con backends tradicionales mientras aprovechan las características de una aplicación web3.

---

# Comenzar

<InstallTabs
	npm="npm i thirdweb"
	yarn="yarn add thirdweb"
	pnpm="pnpm i thirdweb"
	bun="bun i thirdweb"
/>

## Obtén tu ID de Cliente

Para usar Auth en tu aplicación, necesitarás un ID de cliente. Puedes obtener uno de forma gratuita en [tu panel de control de thirdweb](https://thirdweb.com/create-api-key).

## Configuración de Auth

<Tabs defaultValue="react">

<TabsList>
	<TabsTrigger value="react">React</TabsTrigger>
	<TabsTrigger value="typescript">TypeScript</TabsTrigger>
</TabsList>

<TabsContent value="react">
```tsx
import { ThirdwebProvider, ConnectButton } from "thirdweb/react";
import { createThirdwebClient } from "thirdweb";
import { createAuth } from "thirdweb/auth";

const client = createThirdwebClient({
clientId: '1234567890', // get yours by creating a project on https://thirdweb.com/create-api-key
});

const thirdwebAuth = createAuth({
domain: 'localhost:3000',
client,
adminAccount: privateKeyToAccount({ client, privateKey }),
});

export default function App() {
	const [loggedIn, setLoggedIn] = useState(false);
	return (
		// The ThirdwebProvider should be at the root of your application, but the ConnectButton can be anywhere
		<ThirdwebProvider>
			<ConnectButton
				client={client}
				auth={{
					getLoginPayload: async (params) => {
						// here you should call your backend, using generatePayload to return
						// a SIWE compliant login payload to the client
						return thirdwebAuth.generatePayload(params)
					},
					doLogin: async (params) => {
             					// here you should call your backend to verify the signed payload passed in params
						// this will verify that the signature matches the intended wallet
						const verifiedPayload = await thirdwebAuth.verifyPayload(params);
						setLoggedIn(verifiedPayload.valid)
					},
					isLoggedIn: async () => {
						// here you should ask you backend if the user is logged in
						// can use cookies, storage, or your method of choice
						return loggedIn;
					},
					doLogout: async () => {
						// here you should call your backend to logout the user if needed
						// and delete any local auth tokens
						setLoggedIn(false);
					}
				}}
			/>
		</ThirdwebProvider>
	);
}
```
</TabsContent>

<TabsContent value="typescript">

```ts
import { createAuth } from "thirdweb/auth";

const client = createThirdwebClient({
	clientId: "1234567890", // get yours at https://thirdweb.com/create-api-key
});

const auth = createAuth({
	domain: "localhost:3000",
	adminAccount: privateKeyToAccount({ client, privateKey }),
	client,
});

// 1. generate a login payload on the server
const loginPayload = await auth.generatePayload({
	address: "0x123...",
	chain: 1,
});

// 2. sign the login payload on the client
const signature = await auth.signPayload({
	payload: loginPayload,
	account: userAccount,
});

// 3. verify the login payload and signature on the server
const verifiedPayload = await auth.verifyPayload({
	payload: loginPayload,
	signature,
});

// 4. generate a JWT for the client
const jwt = await auth.generateJWT({ payload: verifiedPayload });

// 5. set the JWT as a cookie or store it another way

// 6. authenticate the client based on the JWT on subsequent calls
const { valid, parsedJWT } = await auth.verifyJWT({ jwt });
```

</TabsContent>

<Callout variant="warning" title="Desplegando a Producción">
	Estos ejemplos están destinados a poner en marcha rápidamente, pero no son seguros
	para producción. Antes de desplegar tu aplicación a usuarios reales, revisa nuestra
	guía sobre [Desplegar a Producción](/connect/auth/deploying-to-production).
</Callout>

### Auth con Cuentas Inteligentes (Abstracción de Cuentas)

Al usar Auth con una cuenta inteligente, **debes** especificar un cliente (en `createAuth`) y un ID de cadena (en `generatePayload`). La cuenta inteligente se despliega en una cadena específica y la carga debe reflejar eso, y el cliente es necesario para llamar al contrato de la billetera para verificar la firma.

</Tabs>

## Plantillas

Comienza rápidamente con una de nuestras plantillas:

<OpenSourceCard
	title="Auth + Next.js"
	href="https://github.com/thirdweb-example/thirdweb-auth-next"
	description="A working example of Auth + Next.js"
/>

<OpenSourceCard
	title="Auth + Express"
	href="https://github.com/thirdweb-example/thirdweb-auth-express"
	description="A working example of a React + Express app using Auth"
/>

## Frameworks

Auth se integra con una variedad de frameworks de desarrollo del lado del servidor y del cliente. Siempre estamos añadiendo soporte para más frameworks, así que si no ves el tuyo, [haznoslo saber](https://thirdweb.com/contact-us).

<Stack>

<ArticleIconCard
	title="Next.js"
	href="/connect/auth/frameworks/next"
	description="Integrate Auth in Next.js applications."
	image={next}
/>

<ArticleIconCard
	title="React + Express"
	href="/connect/auth/frameworks/react-express"
	description="Integrate Auth in React applications using Vite and Express."
	image={react}
/>

</Stack>
