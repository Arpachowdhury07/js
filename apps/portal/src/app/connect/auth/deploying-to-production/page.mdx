import {
	createMetadata,
	Callout,
	Tabs,
	TabsContent,
	TabsList,
	TabsTrigger,
} from "@doc";

export const metadata = createMetadata({
	image: {
		title: "Deploying thirdweb Auth",
		icon: "wallets",
	},
	title: "Deploying thirdweb Auth",
	description:
		"A few things to note before deploying thirdweb Auth applications to production.",
});

# Implementar tu Aplicación en Producción

Antes de implementar tu aplicación para usuarios reales, debes asegurarte de que sea segura y esté lista para incorporar usuarios. Esto implica separar algunas operaciones para que se ejecuten en el servidor y otras en el cliente.

Los ejemplos en [Primeros Pasos](/connect/auth) realizan todas las operaciones en el cliente. Los siguientes ejemplos demuestran qué debería ejecutarse en el servidor para garantizar la seguridad de tu aplicación.

<Callout variant="info">
	Parte del código aquí está diseñado para que lo implementes tú mismo. Esto te
	proporciona flexibilidad y control sobre la autenticación de tu aplicación.
	Si prefieres ejemplos específicos, revisa nuestras
	[plantillas](/connect/auth#templates) o nuestras [guías de
	frameworks](/connect/auth#frameworks).
</Callout>


<Tabs defaultValue="client">

<TabsList>
	<TabsTrigger value="client">Client</TabsTrigger>
	<TabsTrigger value="server">Server</TabsTrigger>
</TabsList>

<TabsContent value="client">

En la raíz de tu aplicación:

```tsx
import { ThirdwebProvider } from "thirdweb/react";

export default function App() {
	return <ThirdwebProvider>{/* Your app here */}</ThirdwebProvider>;
}
```

En tu directorio `components`:

```tsx
import { ConnectButton } from "thirdweb/react";
import { createThirdwebClient } from "thirdweb";

const client = createThirdwebClient({ clientId });

export default function Connect() {
	<ConnectButton
		client={client}
		auth={{
			getLoginPayload: async (params) => {
				const address = params.address;
				// Obtén el payload de inicio de sesión aquí usando la dirección
			},
			doLogin: async (params) => {
				// Envía el payload de inicio de sesión firmado (params) al servidor
			},
			isLoggedIn: async () => {
				// Obtén el estado de inicio de sesión del usuario desde el servidor
			},
			doLogout: async () => {
				// Envía una solicitud de cierre de sesión al servidor
			},
		}}
	/>;
}
```

</TabsContent>

<TabsContent value="server">

```ts
import { createThirdwebClient } from "thirdweb";
import { createAuth } from "thirdweb/auth";

const client = createThirdwebClient({
	clientId: "1234567890", // Consíguelo en https://thirdweb.com/create-api-key
});

const thirdwebAuth = createAuth({
	domain: "localhost:3000",
	client,
});

// 1. Genera un payload de inicio de sesión
const loginPayload = await auth.generatePayload({ address: "0x123..." });

// 2. Firma el payload de inicio de sesión
const signature = await auth.signPayload({
	payload: loginPayload,
	account: userAccount,
});

// 3. Verifica el payload de inicio de sesión y la firma que el cliente envía más tarde
const verifiedPayload = await auth.verifyPayload({
	payload: loginPayload,
	signature,
});

// 4. Genera un JWT para el cliente
const jwt = await auth.generateJWT({ payload: verifiedPayload });

// 5. Configura el JWT como una cookie o almacénalo de otra manera

// 6. Autentica al cliente basado en el JWT en llamadas posteriores
const { valid, parsedJWT } = await auth.verifyJWT({ jwt });
```

</TabsContent>

</Tabs>
