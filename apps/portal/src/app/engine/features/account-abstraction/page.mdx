import { createMetadata, Callout } from "@doc";

export const metadata = createMetadata({
	title: "Account Abstraction | thirdweb Engine",
	description:
		"Use Engine to deploy, manage, and transact with smart accounts on behalf of your users",
});

# Abstracción de cuentas

<Callout variant="info" title="¿Buscas usar la abstracción de cuentas para tus operaciones de backend?">
Considera usar [Smart Backend Wallets](/engine/features/backend-wallets#smart-backend-wallets) en su lugar. Combinan la gestión de EOA y de cuentas inteligentes en una sola billetera, con despliegue automático e integración simplificada:

- No necesitas desplegar ni gestionar fábricas de cuentas
- No hay direcciones separadas de cuentas y billeteras backend para hacer seguimiento
- Funciona con todos los endpoints existentes de Engine sin modificaciones
- Agrupación y recuperación de transacciones integradas
- Gestión automática de gas con paymaster

Se recomienda usar billeteras backend inteligentes cuando necesites abstracción de cuentas para tus operaciones de backend. Utiliza el enfoque descrito a continuación cuando necesites gestionar cuentas inteligentes para tus usuarios.

</Callout>

Usa Engine para desplegar, gestionar y realizar transacciones con cuentas inteligentes en nombre de tus usuarios.

## Desplegar una fábrica de cuentas

Para desplegar cuentas inteligentes (denominadas "cuentas" de aquí en adelante), despliega un contrato `AccountFactory`. Este contrato se encarga de desplegar contratos individuales `Account` para tus usuarios.

**Endpoint:** `POST /deploy/<chain>/deployer.thirdweb.eth/AccountFactory`

**Payload:**

```json
{
	"constructorParams": [
		"<default_admin>",
		"0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789"
	] // <default_admin> should be your backend-wallet-address
}
```

## Desplegar cuentas de usuario

Una vez que la fábrica esté configurada, despliega cuentas para tus usuarios.

**Endpoint:** `POST /contract/<chain>/<account_factory_address>/account-factory/create-account`

**Body:**

```json
{
	"adminAddress": "0x..." // The user's wallet address to deploy a smart wallet for
}
```

Esto añade la `adminAddress` como el administrador principal que puede actuar en nombre de la cuenta recién desplegada.

Para controlar la cuenta con una billetera backend, especifica la billetera backend en el campo `adminAddress`.

## Conceder permisos y sesiones

Concede y revoca administradores en una cuenta con los puntos finales `/contract/<chain>/<account_address>/account/admins`.

Concede y revoca sesiones en una cuenta que permiten que billeteras específicas interactúen con contratos especificados durante un período de tiempo con los puntos finales `/contract/<chain>/<account_address>/account/sessions`.

## Realizar transacciones con una cuenta

Realiza llamadas de escritura con una cuenta inteligente llamando a un punto final de escritura y especificando los encabezados `x-backend-wallet-address` y `x-account-address`.

El `x-backend-wallet-address` debe configurarse con la billetera backend de Engine que es un administrador de la cuenta.

El `x-account-address` debe configurarse con la dirección de la cuenta desplegada.

Las llamadas de escritura realizadas utilizando estos encabezados iniciarán una `UserOperation` enviada desde la cuenta especificada.
