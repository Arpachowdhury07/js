
import { DocImage, createMetadata } from "@doc";
import thirdwebmanager_client from "./thirdwebmanager_client.png";
import thirdwebmanager_preferences from "./thirdwebmanager_preferences.png";
import thirdwebmanager_misc from "./thirdwebmanager_misc.png";
import thirdwebmanager_debug from "./thirdwebmanager_debug.png";

export const metadata = createMetadata({
	title: "Thirdweb Manager | SDK de thirdweb para Unity",
	description:
		"ThirdwebManager es un prefab que proporciona una forma conveniente de instanciar el [ThirdwebClient](/dotnet/client) y contiene funciones auxiliares para crear contratos y billeteras. Agrega el prefab a tu escena y el SDK persistirá durante el ciclo de vida de tu juego.",
});

# Thirdweb Manager

El `ThirdwebManager` es un prefab que proporciona una forma conveniente de instanciar el [ThirdwebClient](/dotnet/client), y contiene funciones auxiliares para crear contratos y billeteras. 
Agrega el prefab a tu escena y el cliente persistirá durante todo el ciclo de vida de tu juego, manteniendo un registro de las billeteras conectadas.

Es completamente opcional, y puedes optar por usar directamente el [.NET SDK](/dotnet) si prefieres hacerlo.

Si estás envolviendo el SDK, te recomendamos crear tu propio Manager inspirado en `ThirdwebManager.cs`, específicamente para la inicialización del `ThirdwebClient`.

## Configuración

Configura `ThirdwebManager` a través de la ventana del Inspector de Unity.

A continuación se muestra una lista de todas las configuraciones que puedes ajustar.

### Cliente

<DocImage src={thirdwebmanager_client} />

Esta sección involucra la configuración del cliente de thirdweb para configurar el SDK:

- `Client ID`: Clave [API Key](https://thirdweb.com/create-api-key) de thirdweb. Se utiliza para acceder a los servicios de thirdweb como RPC, Almacenamiento y Abstracción de Cuentas.
- `Bundle ID`: El ID del paquete utilizado para acceder a los servicios de thirdweb desde plataformas nativas. Debe ser el mismo que el ID del paquete en tu proyecto de Unity, por ejemplo, `com.companyname.gamename`.
- `Create API Key`: Un enlace para crear una nueva clave API si no tienes una.

### Preferencias

<DocImage src={thirdwebmanager_preferences} />

Esta sección te permite definir las preferencias predeterminadas para el SDK:

- `Initialize On Awake`: Si el SDK debe inicializarse al despertar o no. Si no, puedes llamar a `ThirdwebManager.Instance.Initialize()` para inicializarlo manualmente.
- `Show Debug Logs`: Si deseas mostrar los registros de depuración del SDK de thirdweb.
- `Opt Out Usage Analytics`: Si deseas optar por no participar en las analíticas de uso de Connect, como la cantidad de billeteras conectadas a tu juego.

### Misceláneos

<DocImage src={thirdwebmanager_misc} />

Esta sección te permite personalizar el comportamiento del SDK:

- `Supported Chains`: Una lista de cadenas a las que las billeteras deberían poder conectarse por defecto cuando se use `WalletConnect` como proveedor de billetera.
- `Redirect Page HTML Override`: HTML en bruto para sobrescribir la página de redirección predeterminada al conectarse a los proveedores `InAppWallet` o `EcosystemWallet`.

### Depuración

<DocImage src={thirdwebmanager_debug} />

Esta sección te permite encontrar información útil:

- `Log Active Wallet Info`: Registra la información de la billetera activa (última conectada), como su dirección.
- `Open Documentation`: Abre la documentación del SDK de thirdweb en tu navegador predeterminado.

## Interactuar con el ThirdwebManager

Una vez que tu `ThirdwebManager` esté configurado, puedes interactuar con él utilizando los siguientes métodos:

### Inicializar (Si no está configurado en `Initialize On Awake`)

```csharp
ThirdwebManager.Instance.Initialize();
```

Inicializa el SDK con la configuración especificada en el Inspector de Unity.

### GetContract

```csharp
var contract = await ThirdwebManager.Instance.GetContract("contract-address", chainId, "optional-contract-abi");
var result = await contract.Read<string>("name");
```

Devuelve una instancia de [ThirdwebContract](/dotnet/contracts/create) que se puede usar para interactuar con un contrato inteligente.

### ConnectWallet

```csharp
var walletOptions = new WalletOptions(WalletProvider.PrivateKeyWallet, 421614);
var wallet = await ThirdwebManager.Instance.ConnectWallet(walletOptions);
var address = await wallet.GetAddress();
```

Conecta una billetera basada en las `WalletOptions` especificadas y devuelve una instancia de `IThirdwebWallet` que se puede usar para interactuar con la blockchain.

### UpgradeToSmartWallet

```csharp
var smartWallet = await ThirdwebManager.Instance.UpgradeToSmartWallet(wallet, chainId, smartWalletOptions);
```

Actualiza la billetera especificada a una `SmartWallet`, devolviendo una instancia de `SmartWallet`.

### LinkAccount

```csharp
var linkedAccounts = await ThirdwebManager.Instance.LinkAccount(mainWallet, walletToLink, otp, chainId, jwtOrPayload);
```

Vincula otra cuenta de `InAppWallet` o `EcosystemWallet` a la billetera principal y devuelve una lista de cuentas vinculadas, lo que te permite iniciar sesión con cualquiera de los métodos de autenticación más adelante.

### GetActiveWallet

```csharp
var wallet = ThirdwebManager.Instance.GetActiveWallet();
```

Devuelve la billetera activa actualmente como un `IThirdwebWallet`.

### SetActiveWallet

```csharp
ThirdwebManager.Instance.SetActiveWallet(wallet);
```

Establece la billetera especificada como la billetera activa.

### GetWallet

```csharp
var wallet = ThirdwebManager.Instance.GetWallet("wallet-address");
```

Devuelve una billetera del mapeo de billeteras del administrador por su dirección.

### AddWallet

```csharp
var wallet = await ThirdwebManager.Instance.AddWallet(wallet);
```

Agrega una billetera al mapeo de billeteras del administrador y devuelve la billetera agregada.

### RemoveWallet

```csharp
ThirdwebManager.Instance.RemoveWallet("wallet-address");
```

Elimina una billetera del mapeo de billeteras del administrador por su dirección.

## Prefabs Hijos

### DefaultOTPModal

El modal de ayuda que se muestra al usar la función `ConnectWallet` de `ThirdwebManager` con un método de autenticación que requiere un OTP, como el inicio de sesión por correo electrónico o teléfono.

Se puede reemplazar con un modal personalizado que extienda `AbstractOTPVerifyModal` para personalizar el proceso de verificación del OTP.

### WalletConnectModal

El prefab `WalletConnectModal` es un modal de WalletConnect listo para usar que se puede utilizar para conectar con más de 400 billeteras.

Se activará automáticamente al conectarse a un proveedor `WalletConnect`.

## ¿Y ahora qué?

Explora el [SDK de .NET](/dotnet) para aprender más sobre cómo interactuar con contratos inteligentes, billeteras, almacenamiento, RPC, abstracción de cuentas y más.
