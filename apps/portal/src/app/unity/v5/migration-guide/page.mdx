
import {
    Callout,
    createMetadata,
} from "@doc";

export const metadata = createMetadata({
    title: "Guía de Migración del SDK de Unity v4 a v5 | SDK de thirdweb para Unity",
    description:
        "Guía de migración del SDK de Unity v4 a v5, que incluye cambios en thirdweb manager, interacción con contratos, conexión de billeteras, almacenamiento, RPC e integración con el SDK de .NET.",
});

# Guía de Migración del SDK de Unity v4 a v5

Esta guía describe el proceso de migración del SDK de thirdweb para Unity v4 a v5. El SDK v5 ofrece características mejoradas y modularidad, y también permite la integración directa con el SDK de .NET.

## Cambios Clave en Unity SDK v5

1. **ThirdwebManager**: El `ThirdwebManager` sigue siendo el punto de entrada recomendado y ofrece una gestión mejorada de billeteras, contratos y el ThirdwebClient principal. Sin embargo, simplemente actúa como un envoltorio para algunas APIs de nivel inferior de nuestro SDK de .NET y es opcional.
2. **Interacción con Contratos**: Las interacciones con contratos se realizan a través de la clase `ThirdwebContract`, que tiene métodos más flexibles como `Prepare`, `Read` y `Write`. Esto permite una interacción más fácil con varias cadenas. También tiene extensiones integradas para tipos comunes de contratos como ERC721, ERC1155, etc.
3. **Gestión de Billeteras**: La gestión de billeteras ha sido modularizada, proporcionando más control sobre los proveedores de billeteras simultáneamente. Puedes instanciar billeteras directamente a través de su función `Create` o mediante `ThirdwebManager.Instance.ConnectWallet`.
4. **Infraestructura**: Se requiere una clave API en v5 para acceder a los servicios de thirdweb como RPC, Almacenamiento, Abstracción de Cuentas y más. Configura tu client id y bundle id en el inspector de `ThirdwebManager`.
5. **Integración con el SDK de .NET**: El SDK de Unity v5 te permite usar directamente el SDK de .NET para una mayor flexibilidad, especialmente en la interacción con contratos y operaciones de billetera.

## Pasos para la Migración

### Actualiza el SDK de Unity a v5

Comienza descargando la última versión del SDK de Unity desde la [página de lanzamientos](https://github.com/thirdweb-dev/unity-sdk/releases). Asegúrate de eliminar los archivos del SDK anterior e importar el nuevo SDK en tu proyecto de Unity.

<Callout variant='info' title="Recomendación">
Es recomendable hacer una copia de seguridad de tu proyecto antes de realizar cualquier actualización importante para evitar la pérdida de datos.
</Callout>

### Directrices Generales

En v5, la mayoría de la gestión del estado se ha movido fuera de `ThirdwebManager` o `ThirdwebSDK`, ya no vinculándote a una cadena o billetera específica en todo momento. El SDK de Unity actúa como un envoltorio para el SDK de .NET, proporcionando una interfaz más amigable para el usuario.

Las configuraciones que previamente saturaban el `ThirdwebManager` se han eliminado, y la mayoría de estas opciones ahora pueden configurarse como opciones en tiempo de ejecución al conectar una billetera o contrato. Esto permite mayor flexibilidad: puedes instanciar tantos contratos y billeteras como necesites, en múltiples cadenas, y cambiar entre ellas fácilmente, o incluso ejecutar múltiples transacciones entre cadenas simultáneamente.

Notarás que la estructura general de funciones y clases es similar a la de v4, pero los argumentos y los tipos de retorno se han actualizado para ser más flexibles y modulares.

### ThirdwebManager

Hemos recreado APIs similares a las de v4 en v5 para facilitar la transición. Todo lo que antes estaba bajo `ThirdwebManager.Instance.SDK` ahora es accesible directamente desde `ThirdwebManager.Instance` o a través de una clase estática. Revisa la documentación del SDK de Unity v5 y .NET para explorar las nuevas APIs.

```csharp
// Unity v4
var contract = ThirdwebManager.Instance.SDK.GetContract(..);

// Unity v5
var contract = await ThirdwebManager.Instance.GetContract(..); // now async
// or with .NET SDK
var contract = await ThirdwebContract.Create(..);
```

### Contratos

La interacción con contratos se ha simplificado en v5. Las interfaces de contrato específicas (por ejemplo, ERC721, ERC1155) ahora se manejan a través de `ThirdwebContract` con métodos de extensión más flexibles.

```csharp
// Unity v4
var balance = await contract.ERC1155.Balance(..);

// Unity v5
var balance = await contract.ERC1155_Balance(..);

// contract.Prepare, contract.Read, contract.Write, etc. are available and take in a chain id
```

### Billeteras

En v5, las billeteras son más modulares. Puedes conectar múltiples billeteras simultáneamente y cambiar entre ellas fácilmente.

```csharp
// Unity v4
var connection = new WalletConnection(..);
var address = await ThirdwebManager.Instance.SDK.Wallet.Connect(connection);

// Unity v5
var options = new WalletOptions(..);
var wallet = await ThirdwebManager.Instance.ConnectWallet(options);
// or instantiate the wallet directly with .NET SDK
var wallet = await PrivateKeyWallet.Create(..);

// Extensions for common wallet operations are available
var address = await wallet.GetAddress();
```

### Almacenamiento

v5 requiere una clave API para los servicios de almacenamiento y RPC. Puedes generar una clave API desde el panel de control de thirdweb e integrarla en tu proyecto de Unity.

```csharp
// Unity v4
var data = await ThirdwebManager.Instance.SDK.Storage.DownloadText<string>("{{text_uri}}");

// Unity v5
var data = await ThirdwebStorage.Download<string>("{{text_uri}}");
```

## UI

Si estabas utilizando nuestros prefabs de ejemplo de v4 en producción, es posible que necesites hacer una copia de seguridad de ellos, ya que han sido eliminados en v5. Aún puedes usarlos como referencia para crear tus propios prefabs en v5.

Puedes optar por adaptar su código a v5 o recrear tu propia interfaz de usuario y utilizar las nuevas APIs que ofrecemos.

Generalmente, para un botón de conexión de billetera, todo lo que necesitas hacer es llamar a `var wallet = await ThirdwebManager.Instance.ConnectWallet` con las opciones adecuadas.

Luego, puedes mostrar el saldo usando `await wallet.GetBalance` u otros métodos de extensión. `Utils.GetChainMetadata` te ayudará a encontrar símbolos de tokens nativos y más, de manera dinámica.

Nuevos prefabs listos para producción estarán disponibles en futuras versiones.

### Referencia Completa

La [Documentación del SDK de .NET](/dotnet) proporciona una referencia completa para todas las clases y métodos disponibles en el SDK de Unity v5.
