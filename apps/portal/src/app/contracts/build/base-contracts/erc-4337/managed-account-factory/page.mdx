import { Details, Callout } from "@doc";
import { GithubButtonLink } from "@doc";
import { createMetadata } from "@doc";

export const metadata = createMetadata({
	image: {
		title: "Contrato de Fábrica de Cuenta Administrada",
		icon: "contract",
	},
	title: "Fábrica de Cuenta Administrada | contratos thirdweb",
	description:
		"Este contrato inteligente de fábrica está destinado a ser utilizado para distribuir Cuentas Administradas de forma programática",
});

# Fábrica de Cuenta Administrada

```solidity
import "@thirdweb-dev/contracts/smart-wallet/managed/ManagedAccountFactory.sol";
```

Este contrato hereda del contrato [`BaseAccountFactory`](/contracts/build/extensions/erc-4337/SmartWallet-factory).

Este contrato inteligente de fábrica está destinado a ser utilizado para distribuir ['Cuentas Administradas'](/contracts/build/base-contracts/erc-4337/managed-account) de forma programática.

<GithubButtonLink href="https://github.com/thirdweb-dev/contracts/blob/main/contracts/prebuilts/account/managed/ManagedAccountFactory.sol" />

<br />

<Callout title="Contrato Modificado" variant="info">

Si modificas el contrato [`ManagedAccount`](/contracts/build/base-contracts/erc-4337/managed-account), se recomienda escribir tu propio
contrato de fábrica heredando de la extensión [`BaseAccountFactory`](/contracts/build/extensions/erc-4337/SmartWallet-factory).

</Callout>

## Extensiones Detectadas

Una vez desplegado, puedes usar las características disponibles por estas extensiones en el SDK y el panel de control:

- [SmartWalletFactory](/contracts/build/extensions/erc-4337/SmartWallet-factory)

## Uso

Usa el comando [`create`](/cli/create) del [CLI](/cli) para crear un contrato inteligente `ManagedAccountFactory`:

```bash
npx thirdweb create contract
```

[Desplegar](/contracts/deploy/overview) tu contrato usando el comando del CLI de despliegue:

```bash
npx thirdweb create
```

O importa el contrato en tu proyecto existente e inhíerelo.

```solidity
import "@thirdweb-dev/contracts/smart-wallet/managed/ManagedAccountFactory.sol";

contract MyManagedAccountFactory is ManagedAccountFactory {
	  constructor(
        IEntryPoint _entrypoint
    )
        ManagedAccountFactory(
            _entrypoint
        )
    {}
}
```
## Funciones para Sobrescribir

Las siguientes funciones han sido implementadas en este contrato y están disponibles para ser sobrescritas para agregar lógica personalizada:

<Details id="_initializeAccount" summary="_initializeAccount">

Se llama en `createAccount`. Inicializa el contrato de cuenta creado en `createAccount`.

```solidity
function _initializeAccount(
    address _account,
    address _admin,
    bytes calldata _data
) internal override {
    ManagedAccount(payable(_account)).initialize(_admin, _data);
}
```

#### \_account

La dirección del contrato inteligente de cuenta para inicializar.

#### \_admin

La dirección que se establecerá como el rol de administrador predeterminado para el contrato. Debe ser de tipo `address`.

#### \_data

Si se requieren variables adicionales de almacenamiento en tu contrato de cuenta, codifica en ABI las variables,
y pásalas a esta función como el argumento `bytes`.

Por ejemplo:

```solidity

function initializeAccount(
    address _admin,
    bytes calldata _data
) public override initializer {
    ManagedAccount.initialize(_admin, _data);
}
```

</Details>

<Details id="_canSetExtension" summary="_canSetExtension">

Devuelve si una extensión puede ser configurada en el contexto de ejecución dado.

```solidity
function _canSetExtension() internal view virtual override returns (bool) {
    return hasRole(DEFAULT_ADMIN_ROLE, msg.sender);
}
```

</Details>
