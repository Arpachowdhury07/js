import { Details, GithubButtonLink } from "@doc";
import { createMetadata } from "@doc";

export const metadata = createMetadata({
  image: {
    title: "Contrato ERC1155Staking",
    icon: "solidity",
  },
  title: "ERC1155Staking | contrato de thirdweb",
  description:
    "La extensión de contrato Staking1155 implementa el mecanismo de staking de NFTs para ERC1155",
});


# ERC1155Staking

```solidity
import "@thirdweb-dev/contracts/extension/Staking1155.sol";
```

La extensión de contrato `Staking1155` implementa el mecanismo de staking de NFTs para ERC1155. Con esta extensión, puedes configurar un contrato de staking para los poseedores de NFTs de tu colección ERC1155. Los usuarios pueden hacer staking de sus NFTs y ganar tokens ERC20 como recompensas.

<GithubButtonLink href="https://github.com/thirdweb-dev/contracts/blob/main/contracts/extension/Staking1155.sol" />

## Uso

Este es un ejemplo de contrato inteligente que demuestra cómo heredar de esta extensión y sobrescribir las funciones para agregar (opcionalmente) funcionalidad personalizada.

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "@thirdweb-dev/contracts/extension/Staking1155.sol";
import "@thirdweb-dev/contracts/eip/interface/IERC20.sol";

contract MyContract is Staking1155 {
    // ERC20 Reward Token address. See {_mintRewards}.
    address public rewardToken;

    /**
     *  Almacenamos la dirección del desplegador del contrato solo para fines del ejemplo
     *  en el comentario de código a continuación.
     *
     *  Hacer esto no es necesario para usar la extensión `Staking1155`.
     */
    address public deployer;

    constructor(
        uint256 _defaultTimeUnit,
        uint256 _defaultRewardsPerUnitTime,
        address _stakingToken,
        address _rewardToken
    ) Staking1155(_stakingToken) {
        _setDefaultStakingCondition(_defaultTimeUnit, _defaultRewardsPerUnitTime);

        rewardToken = _rewardToken;
        deployer = msg.sender;
    }

    /**
     *  @dev    Mint/Transfer ERC20 rewards to the staker. Must override.
     *
     *  @param _staker    Address for sending rewards to.
     *  @param _rewards   Amount of tokens to be given out as reward.
     *
     */
    function _mintRewards(address _staker, uint256 _rewards) internal override {
        IERC20(rewardToken).transfer(_staker, _rewards);
    }

    // Returns whether staking restrictions can be set in given execution context.
    function _canSetStakeConditions() internal view override returns (bool) {
        return msg.sender == deployer;
    }
}
```

## Contratos de Base que implementan esta extensión

- [Staking1155Base](/contracts/build/base-contracts/erc-1155/staking)

## Referencia Completa de la API


<Details summary="stake">

```solidity
function stake(uint256 tokenId, uint256 amount) external;
```

- Permite a un usuario apostar una cantidad de tokens ERC1155 de un token-id específico.
- Parámetro `tokenId`: El ID de token ERC1155 para apostar.
- Parámetro `amount`: Cantidad a apostar.

</Details>

<Details summary="withdraw">

```solidity
function stake(uint256 tokenId, uint256 amount) external;
```

- Retirar y deshacer la apuesta de NFTs del contrato.
- Parámetro `tokenId`: El ID de token ERC1155 para retirar.
- Parámetro `amount`: Cantidad a retirar.

</Details>

<Details summary="claimRewards">

```solidity
function claimRewards(uint256 tokenId) external;
```

- Reclamar recompensas acumuladas. Este método de reclamación permite un mecanismo de extracción donde los usuarios deben iniciar la reclamación de recompensas.
- Parámetro `tokenId`: El ID de token ERC1155 para el cual reclamar recompensas.

</Details>

<Details summary="getStakeInfo">

```solidity
function getStakeInfo(address staker) external view returns (uint256[] memory tokensStaked, uint256[] memory tokenAmounts, uint256 totalRewards)
```

- Ver el número de NFTs apostados y las recompensas totales disponibles para un usuario.
- Parámetro `staker`: Dirección de la cuenta del apostador.

</Details>

<Details summary="getStakeInfoForToken">

```solidity
function getStakeInfoForToken(uint256 tokenId, address staker) external view returns (uint256 tokensStaked, uint256 rewards)
```

- Ver el número de NFTs apostados y las recompensas totales disponibles para un usuario.
- Parámetro `tokenId`: El token-id ERC1155 para ver las recompensas.
- Parámetro `staker`: Dirección de la cuenta del apostador.

</Details>

<Details summary="setRewardsPerUnitTime">

```solidity
function setRewardsPerUnitTime(uint256 tokenId, uint256 rewardsPerUnitTime) external;
```

- Permite que una cuenta autorizada establezca las recompensas por unidad de tiempo. Se interpreta como x recompensas por segundo/día/etc., según la unidad de tiempo.
- Parámetro `tokenId`: El token-id ERC1155 para el cual se establece esto.
- Parámetro `rewardsPerUnitTime`: Nuevas recompensas por unidad de tiempo.

</Details>

<Details summary="setTimeUnit">

```solidity
function setTimeUnit(uint256 tokenId, uint256 timeUnit) external;
```

- Permite que una cuenta autorizada establezca la unidad de tiempo como un número de segundos. Por ejemplo, se puede establecer 1 hora como 3600 segundos, configurando la frecuencia de recompensas como _por hora_.
- Parámetro `tokenId`: El token-id ERC1155 para el cual se establece esto.
- Parámetro `timeUnit`: Nueva unidad de tiempo.

</Details>

<Details summary="setDefaultRewardsPerUnitTime">

```solidity
function setDefaultRewardsPerUnitTime(uint256 defaultRewardsPerUnitTime) external;
```

- Permite que una cuenta autorizada establezca las recompensas por unidad de tiempo aplicables a todos los token-Ids por defecto.
- Parámetro `defaultRewardsPerUnitTime`: Nuevas recompensas por unidad de tiempo.

</Details>

<Details summary="setDefaultTimeUnit">

```solidity
function setDefaultTimeUnit(uint256 defaultTimeUnit) external;
```

- Permite que una cuenta autorizada establezca la unidad de tiempo aplicable a todos los token-Ids por defecto.
- Parámetro `defaultTimeUnit`: Nueva unidad de tiempo.

</Details>
