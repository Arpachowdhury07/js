import { Details, GithubButtonLink, createMetadata } from "@doc";

export const metadata = createMetadata({
	image: { title: "Contrato Royalty", icon: "solidity" },
	title: "Royalty | Contrato de thirdweb",
	description:
		"Royalty implementa el estándar EIP-2981 de regalías para soporte de regalías en los mercados de NFT, permitiéndote tomar una tarifa porcentual de las ventas secundarias de tus NFTs",
});

# Royalty

```solidity
import "@thirdweb-dev/contracts/extension/Royalty.sol";
```

`Royalty` implementa el estándar de regalías NFT [EIP-2981](https://eips.ethereum.org/EIPS/eip-2981) para soporte de regalías en los mercados de NFT, permitiéndote tomar una tarifa porcentual de las ventas secundarias de tus NFTs.

<GithubButtonLink href="https://github.com/thirdweb-dev/contracts/blob/main/contracts/extension/Royalty.sol" />

## Uso

La extensión `Royalty` es un _contrato abstracto_, y espera que implementes las siguientes funciones por ti mismo:

| Nombre                                                                                   | Tipo                    | Devuelve | Descripción                                                                                                                       |
| ---------------------------------------------------------------------------------------- | ----------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------- |
| [`_canSetRoyaltyInfo`](/contracts/build/extensions/general/Royalty#_cansetroyaltyinfo) | internal view _virtual_ | `bool`   | Se ejecuta en cada intento de establecer un nuevo receptor de regalías o BPS. Devuelve si esta información puede ser establecida en el contexto de ejecución dado. |

Este es un contrato inteligente de ejemplo que demuestra cómo heredar de esta extensión y sobrescribir las funciones para agregar (opcionalmente) funcionalidad personalizada.

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "@thirdweb-dev/contracts/extension/Royalty.sol";

contract MyContract is Royalty {
    /**
     *  Almacenamos la dirección del desplegador del contrato solo para los fines del ejemplo
     *  en el comentario de código a continuación.
     *
     *  Hacer esto no es necesario para usar la extensión `Royalty`.
     */
    address public deployer;

    constructor() {
        deployer = msg.sender;
    }

    function supportsInterface(bytes4 interfaceId)
        public
        view
        virtual
        returns (bool)
    {
        return type(IERC2981).interfaceId == interfaceId;
    }

    /**
     *  Esta función devuelve quién está autorizado para establecer la información de regalías para tu contrato NFT.
     *
     *  Como EJEMPLO, solo permitiremos que el desplegador del contrato establezca la información de regalías.
     *
     *  DEBES completar el cuerpo de esta función para usar la extensión `Royalty`.
     */
    function _canSetRoyaltyInfo()
        internal
        view
        virtual
        override
        returns (bool)
    {
        return msg.sender == deployer;
    }
}
```

## Contratos Base que Implementan Esta Extensión

Todos los contratos NFT ([`ERC721`](/contracts/build/extensions/erc-721/ERC721) o [`ERC1155`](/contracts/build/extensions/erc-1155/ERC1155)) implementan esta extensión.

## Referencia Completa de la API

<Details summary="royaltyInfo">

```solidity
function royaltyInfo(uint256 tokenId, uint256 salePrice)
    external
    view
    virtual
returns (address receiver, uint256 royaltyAmount)
```

- Devuelve el receptor de regalías y la cantidad para un NFT dado y su precio de venta.
- Parámetro `tokenId`: El tokenID del NFT para el cual consultar la información de regalías.
- Parámetro `salePrice`: Precio de venta del NFT.

</Details>

<Details summary="getRoyaltyInfoForToken">

```solidity
function getRoyaltyInfoForToken(uint256 tokenId) public view override returns (address, uint16);
```

- Devuelve el receptor de regalías y los BPS para un NFT dado.
- Parámetro `tokenId`: El tokenID del NFT para el cual consultar la información de regalías.

</Details>

<Details summary="getDefaultRoyaltyInfo">

```solidity
function getDefaultRoyaltyInfo() external view override returns (address, uint16);
```

- Devuelve el receptor de regalías predeterminado y los BPS para los NFTs del contrato.

</Details>

<Details summary="setDefaultRoyaltyInfo">

```solidity
function setDefaultRoyaltyInfo(address royaltyRecipient, uint256 royaltyBps) external;
```

- Permite que una billetera autorizada establezca el receptor de regalías predeterminado y los BPS para el NFT del contrato.
- Parámetro `royaltyRecipient`: La dirección que se establecerá como el nuevo receptor de regalías predeterminado.
- Parámetro `royaltyBps`: El valor que se establecerá como el nuevo BPS de regalías predeterminado.
- La función `_canSetRoyaltyInfo` se ejecuta en cada llamada a esta función. Si el valor devuelto de `_canSetRoyaltyInfo` es `false`, la llamada a `setDefaultRoyaltyInfo` se revertirá.

</Details>

<Details summary="setRoyaltyInfoForToken">

```solidity
function setRoyaltyInfoForToken(
    uint256 tokenId,
    address recipient,
    uint256 bps
) external
```

- Permite que una billetera autorizada establezca el receptor de regalías y los BPS para un NFT particular del contrato.
- Parámetro `tokenId`: El tokenId del NFT para el cual establecer la información de regalías.
- Parámetro `recipient`: La dirección que se establecerá como el nuevo receptor de regalías para el NFT.
- Parámetro `bps`: El valor que se establecerá como el nuevo BPS de regalías para el NFT.
- La función `_canSetRoyaltyInfo` se ejecuta en cada llamada a esta función. Si el valor devuelto de `_canSetRoyaltyInfo` es `false`, la llamada a `setRoyaltyInfoForToken` se revertirá.

</Details>

<Details summary="_setupDefaultRoyaltyInfo">

```solidity
function _setupDefaultRoyaltyInfo(address royaltyRecipient, uint256 royaltyBps) internal;
```

- Establece el receptor de regalías predeterminado y los BPS para los NFTs del contrato.
- Parámetro `royaltyRecipient`: La dirección que se establecerá como el nuevo receptor de regalías predeterminado.
- Parámetro `royaltyBps`: El valor que se establecerá como el nuevo BPS de regalías predeterminado.
- La función `_canSetRoyaltyInfo` _no_ se ejecuta en una llamada a esta función.

</Details>

<Details summary="_setupRoyaltyInfoForToken">

```solidity
function _setupDefaultRoyaltyInfo(address royaltyRecipient, uint256 royaltyBps) internal;
```

- Establece el receptor de regalías y los BPS para un NFT particular del contrato.
- Parámetro `tokenId`: El tokenId del NFT para el cual establecer la información de regalías.
- Parámetro `recipient`: La dirección que se establecerá como el nuevo receptor de regalías para el NFT.
- Parámetro `bps`: El valor que se establecerá como el nuevo BPS de regalías para el NFT.
- La función `_canSetRoyaltyInfo` _no_ se ejecuta en una llamada a esta función.

</Details>

<Details summary="_canSetRoyaltyInfo">

```solidity
function _canSetRoyaltyInfo() internal view virtual returns (bool);
```

- Se ejecuta en cada llamada a las funciones `setDefaultRoyaltyInfo` y `setRoyaltyInfoForToken`.
- Devuelve si la información de regalías relevante puede ser establecida en el contexto de ejecución dado.
- Por ejemplo, esta función puede verificar si la billetera que llama a `setDefaultRoyaltyInfo` es el propietario del contrato, y hacer cumplir que solo el propietario pueda llamar exitosamente a `setDefaultRoyaltyInfo`.

</Details>
