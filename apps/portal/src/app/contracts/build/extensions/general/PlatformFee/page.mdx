import { Details, GithubButtonLink, createMetadata } from "@doc";

export const metadata = createMetadata({
	image: {
		title: "Contrato PlatformFee",
		icon: "solidity",
	},
	title: "PlatformFee | Contrato de thirdweb",
	description:
		"PlatformFee te permite cobrar una tarifa porcentual cada vez que haya una transferencia de moneda (tokens ERC20 o tokens nativos) en tu contrato",
});

# PlatformFee

```solidity
import "@thirdweb-dev/contracts/extension/PlatformFee.sol";
```

`PlatformFee` te permite cobrar una tarifa porcentual cada vez que haya una transferencia de moneda (tokens ERC20 o tokens nativos) en tu contrato.

<GithubButtonLink href="https://github.com/thirdweb-dev/contracts/blob/main/contracts/extension/PlatformFee.sol" />

## Uso

La extensión `PlatformFee` es un _contrato abstracto_, y espera que implementes las siguientes funciones por ti mismo:

| Nombre                                                                                               | Tipo                    | Devuelve | Descripción                                                                                                                            |
| ---------------------------------------------------------------------------------------------------- | ----------------------- | -------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| [`_canSetPlatformFeeInfo`](/contracts/build/extensions/general/PlatformFee#_cansetplatformfeeinfo) | internal view _virtual_ | `bool`   | Se ejecuta en cada intento de establecer un nuevo receptor de tarifa de la plataforma o bps. Devuelve si esta información puede ser establecida en el contexto de ejecución dado. |

Este es un contrato inteligente de ejemplo que demuestra cómo heredar de esta extensión y sobrescribir las funciones para agregar (opcionalmente) funcionalidad personalizada.

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "@thirdweb-dev/contracts/extension/PlatformFee.sol";

contract MyContract is PlatformFee {
    /**
     *  Almacenamos la dirección del desplegador del contrato solo para los fines del ejemplo
     *  en el comentario de código a continuación.
     *
     *  Hacer esto no es necesario para usar la extensión `PlatformFee`.
     */
    address public deployer;

    constructor() {
        deployer = msg.sender;
    }

    /**
     *  Esta función devuelve quién está autorizado para establecer la información de la tarifa de la plataforma para tu contrato.
     *
     *  Como EJEMPLO, solo permitiremos que quien despliegue el contrato establezca la información de la tarifa de la plataforma.
     *
     *  DEBES completar el cuerpo de esta función para usar la extensión `PlatformFee`.
     */
    function _canSetPlatformFeeInfo() internal view virtual override returns (bool) {
        return msg.sender == deployer;
    }
}
```

## Contratos Base que Implementan Esta Extensión

Ninguno de los contratos base implementa esta extensión.

## Referencia Completa de la API

<Details summary="getPlatformFeeInfo">

```solidity
function getPlatformFeeInfo() public view returns (address, uint16);
```

- Devuelve el receptor de la tarifa de la plataforma y los bps.
- Establece este valor usando la función `setPlatformFeeInfo`.

</Details>

<Details summary="setPlatformFeeInfo">

```solidity
function setPlatformFeeInfo(address platformFeeRecipient, uint256 platformFeeBps) external;
```

- Permite que una billetera autorizada establezca el receptor de la tarifa de la plataforma y los bps.
- Parámetro `platformFeeRecipient`: La dirección que se establecerá como el nuevo receptor de la tarifa de la plataforma.
- Parámetro `platformFeeBps`: El valor que se establecerá como los nuevos bps de la tarifa de la plataforma.
- La función `_canSetPlatformFeeInfo` se ejecuta en cada llamada a esta función. Si el valor devuelto de `_canSetPlatformFeeInfo` es `false`, la llamada a `setPlatformFeeInfo` se revertirá.

</Details>

<Details summary="_setupPlatformFeeInfo">

```solidity
function _setupPlatformFeeInfo(address platformFeeRecipient, uint256 platformFeeBps) internal;
```

- Establece el receptor de la tarifa de la plataforma y los bps.
- Parámetro `platformFeeRecipient`: La dirección que se establecerá como el nuevo receptor de la tarifa de la plataforma.
- Parámetro `platformFeeBps`: El valor que se establecerá como los nuevos bps de la tarifa de la plataforma.
- La función `_canSetPlatformFeeInfo` _no_ se ejecuta en una llamada a esta función.

</Details>

<Details summary="_canSetPlatformFeeInfo">

```solidity
function _canSetPlatformFeeInfo() internal view virtual returns (bool);
```

- Se ejecuta en cada llamada a la función `setPlatformFeeInfo`.
- Devuelve si se puede establecer un nuevo receptor de tarifa de la plataforma o bps en el contexto de ejecución dado.
- Por ejemplo, esta función puede verificar si la billetera que llama a `setPlatformFeeInfo` es el propietario del contrato, y hacer cumplir que solo el propietario actual pueda llamar exitosamente a `setPlatformFeeInfo`.

</Details>
