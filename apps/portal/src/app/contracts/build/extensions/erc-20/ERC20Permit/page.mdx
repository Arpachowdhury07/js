import { Callout } from "@doc";
import { GithubButtonLink } from "@doc";
import { createMetadata } from "@doc";

export const metadata = createMetadata({
	image: {
		title: "Contrato ERC721Permit",
		icon: "solidity",
	},
	title: "ERC721Permit | contrato de thirdweb",
	description:
		"La implementación de las extensiones ERC20Permit permite que las aprobaciones se realicen a través de firmas, tal como se define en el EIP-2612",
});

# ERC721Permit

```solidity
import "@thirdweb-dev/contracts/eip/interface/IERC20Permit.sol";
```

La implementación de las extensiones `ERC20Permit` permite que las aprobaciones se realicen mediante firmas, tal como se define en [EIP-2612](https://eips.ethereum.org/EIPS/eip-2612).

La función `permit` se puede utilizar para cambiar la asignación de ERC20 de una cuenta (IERC20-allowance) presentando un mensaje firmado por la cuenta. Al no depender de (IERC20-approve), la cuenta del titular del token no necesita enviar una transacción y, por lo tanto, no se requiere que tenga Ether en absoluto.

<Callout title="info" variant="info">

Esta extensión es una interfaz y requiere que todas las funciones sean implementadas.

</Callout>

<br />

<GithubButtonLink href="https://github.com/thirdweb-dev/contracts/blob/main/contracts/eip/interface/IERC20Permit.sol" />

## Uso

Este es un contrato inteligente de ejemplo que demuestra cómo heredar de esta extensión y sobrescribir las funciones para agregar (opcionalmente) funcionalidades personalizadas.

El contrato [ERC721A](/contracts/build/extensions/erc-721/ERC721) viene con una función `totalPermit`
que devuelve el número total de NFTs que se han acuñado en la colección (incluyendo los tokens que han sido quemados).

Esto significa que ya puedes ver el total de Permisos de NFTs en la colección implementando el contrato `ERC721A`.

Opcionalmente, puedes sobrescribir la funcionalidad de esta función como se detalla a continuación:

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "@thirdweb-dev/contracts/openzeppelin-presets/token/ERC20/ERC20.sol";
import "@thirdweb-dev/contracts/eip/interface/IERC20Permit.sol";

contract Contract is ERC20, IERC20Permit {
    constructor(
        string memory _name,
        string memory _symbol
    )
        ERC20(
            _name,
            _symbol
        )
    {}

    /**
     * @dev Establece `value` como la asignación de `spender` sobre los tokens de `owner`,
     * dado la aprobación firmada de `owner`.
     *
     * IMPORTANTE: Los mismos problemas que tiene {IERC20-approve} relacionados con el
     * orden de las transacciones también se aplican aquí.
     *
     * Emite un evento {Approval}.
     *
     * Requisitos:
     *
     * - `spender` no puede ser la dirección cero.
     * - `deadline` debe ser una marca de tiempo en el futuro.
     * - `v`, `r` y `s` deben ser una firma válida `secp256k1` de `owner`
     * sobre los argumentos de la función formateados en EIP712.
     * - la firma debe usar el nonce actual de `owner` (ver {nonces}).
     *
     * Para más información sobre el formato de la firma, consulta la
     * https://eips.ethereum.org/EIPS/eip-2612#specification[sección relevante de EIP].
     */
    function permit(
        address owner,
        address spender,
        uint256 value,
        uint256 deadline,
        uint8 v,
        bytes32 r,
        bytes32 s
    ) external {
        // Your custom implementation here
    }

    /**
     * @dev Devuelve el nonce actual de `owner`. Este valor debe ser
     * incluido cada vez que se genere una firma para {permit}.
     *
     * Cada llamada exitosa a {permit} incrementa el nonce de `owner` en uno. Esto
     * previene que una firma se use varias veces.
     */
    function nonces(address owner) external view returns (uint256) {
        // Tu implementación personalizada aquí
    }

    /**
     * @dev Returns the domain separator used in the encoding of the signature for {permit}, as defined by {EIP712}.
     */
    // solhint-disable-next-line func-name-mixedcase
    function DOMAIN_SEPARATOR() external view returns (bytes32) {
        // Tu implementación personalizada aquí
    }

}
```

## Contratos base que implementan esta extensión

- [ERC20Base](/contracts/build/base-contracts/erc-20/base)
- [ERC20Drop](/contracts/build/base-contracts/erc-20/drop)
- [ERC20DropVote](/contracts/build/base-contracts/erc-20/drop-vote)
- [ERC20SignatureMint](/contracts/build/base-contracts/erc-20/signature-mint)
- [ERC20SignatureMintVote](/contracts/build/base-contracts/erc-20/signature-mint-vote)
- [ERC20Vote](/contracts/build/base-contracts/erc-20/base)
