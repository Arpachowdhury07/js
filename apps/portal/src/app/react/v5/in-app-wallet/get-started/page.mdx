import {
	Tabs,
	TabsList,
	TabsTrigger,
	TabsContent,
	Callout,
	DocImage,
	createMetadata,
	AuthList,
	ArticleIconCard,
	Stack,
	Steps,
	Step
} from "@doc";
import {ExternalLink} from "lucide-react";

export const metadata = createMetadata({
	title: "Conectar usuarios con carteras en la aplicación",
	description:
		"Usa los componentes de UI de conexión preconstruidos para autenticar usuarios y conectar carteras en la aplicación",
	image: {
		title: "Conectar usuarios con carteras en la aplicación",
		icon: "wallets",
	},
});

# Carteras en la Aplicación

Crea una cartera en la aplicación para tus usuarios basada en su correo electrónico, teléfono, clave de acceso, autenticación social o incluso sus carteras externas. Estas carteras están vinculadas a tu clientId y no requieren ninguna confirmación para firmar transacciones.

## Métodos de autenticación disponibles

<AuthList />

## Playground en vivo

Prueba las carteras en la aplicación por ti mismo en el [playground en vivo de carteras en la aplicación](https://playground.thirdweb.com/connect/in-app-wallet)

<Stack>

<ArticleIconCard
	title="Prueba la demostración"
	icon={ExternalLink}
	href="https://playground.thirdweb.com/connect/in-app-wallet"
	description="Ve el SDK en acción en el playground en vivo"
/>

</Stack>

## Configurar carteras en la aplicación

La forma más sencilla de crear una cartera en la aplicación es usar la función `inAppWallet()`. De manera predeterminada, esto creará una cartera que admite inicio de sesión con correo electrónico/contraseña, Google, Apple, inicio de sesión de Facebook y clave de acceso.

```tsx
import { inAppWallet } from "thirdweb/wallets";

const wallet = inAppWallet();
```

You can also customize the wallet by passing in options.

```tsx
import { inAppWallet } from "thirdweb/wallets";

const wallet = inAppWallet({
	auth: {
        mode, // options are "popup" | "redirect" | "window";
        options, // ex: ["discord", "farcaster", "apple", "facebook", "google", "passkey"],
        passkeyDomain, // for passkey, the domain that the passkey is created on
        redirectUrl, // the URL to redirect to after authentication
	},
	metadata, // metadata for the wallet (name, icon, etc.)
	smartAccount, // smart account options for the wallet (for gasless tx)
});
```

[Ver todas las opciones de cartera en la aplicación](/references/typescript/v5/InAppWalletCreationOptions).

Una vez creada, puedes usarla ya sea con los componentes UI preconstruidos o con tu propia interfaz de usuario.

## Uso con componentes UI de Conexión

La forma más sencilla de usar las carteras en la aplicación es usando los componentes UI de conexión preconstruidos como [`ConnectButton`](/references/typescript/v5/ConnectButton) y [`ConnectEmbed`](/references/typescript/v5/ConnectEmbed) para autenticar a los usuarios y conectar sus carteras.

De manera predeterminada, la UI de conexión admite múltiples inicios de sesión sociales, así como autenticación por correo electrónico, teléfono y clave de acceso. Puedes personalizar qué métodos de autenticación deseas admitir, los cuales se reflejarán en la UI.

<Callout variant="info" title="Orden de autenticación">
	De manera predeterminada, el inicio de sesión por correo electrónico se muestra antes que el inicio de sesión por número de teléfono. Para mostrar primero el teléfono, agrega "phone" antes de "email" en el array de proveedores.
</Callout>


```tsx
import { ThirdwebProvider, ConnectButton } from "thirdweb/react";
import { inAppWallet } from "thirdweb/wallets";

const client = createThirdwebClient({ clientId });
const wallets = [inAppWallet({
	auth: { options: ["email", "passkey", "google"] }
})];

export default function App() {
	return (
		<ThirdwebProvider>
			<ConnectButton client={client} wallets={wallets} />
		</ThirdwebProvider>
	);
}
```

## Uso con tu propia UI

Tienes control total con los hooks y funciones de conexión para crear tu propia UI. Elige una estrategia de autenticación y luego conéctate.

### Configura el ThirdwebProvider

Esto asegurará que la cartera esté disponible para todos los componentes en tu aplicación, maneje los estados de conexión y realice la conexión automática al cargar la página.

```jsx
import { ThirdwebProvider } from "thirdweb/react";

<ThirdwebProvider>
	<YourApp />
</ThirdwebProvider>;
```

### Autenticarse vía Google

Ten en cuenta que para Apple y Facebook, solo necesitas actualizar la estrategia a "facebook" o "apple".

En React y React Native, el hook `useConnect()` maneja la autenticación y los estados de conexión.

```tsx
import { inAppWallet } from "thirdweb/wallets";
import { useConnect } from "thirdweb/react";

const { connect } = useConnect();

const handleLogin = async () => {
	await connect(async () => {
		const wallet = inAppWallet();
		await wallet.connect({
			client,
			strategy: "google",
		});
		return wallet;
	});
};
```

Otras opciones sociales incluyen Apple, Facebook, Discord, Farcaster y más.

### Autenticarse mediante verificación de correo electrónico

```typescript
import { inAppWallet, preAuthenticate } from "thirdweb/wallets/in-app";

const { connect } = useConnect();

const preLogin = async (email: string) => {
	// send email verification code
	await preAuthenticate({
		client,
		strategy: "email",
		email, // ex: user@example.com
	});
};

const handleLogin = async (email: string, verificationCode: string) => {
	// verify email and connect
	await connect(async () => {
		const wallet = inAppWallet();
		await wallet.connect({
			client,
			strategy: "email",
			email,
			verificationCode,
		});
		return wallet;
	});
};
```

### Autenticarse mediante verificación de número de teléfono


```typescript
import { inAppWallet, preAuthenticate } from "thirdweb/wallets/in-app";

const { connect } = useConnect();

const preLogin = async (phoneNumber: string) => {
	// send phone number verification code
	await preAuthenticate({
		client,
		strategy: "phone",
		phoneNumber, // ex: +1234567890
	});
};

const handleLogin = async (phoneNumber: string, verificationCode: string) => {
	// verify phone number and connect
	await connect(async () => {
		const wallet = inAppWallet();
		await wallet.connect({
			client,
			strategy: "phone",
			phoneNumber,
			verificationCode,
		});
		return wallet;
	});
};
```

### Autenticarse mediante Passkey

<Callout variant="info" title="Soporte para React Native">

Para React Native, se requiere `passkeyDomain` y debe configurarse con un enlace universal válido de la aplicación. Para configurar los enlaces universales para tu aplicación, sigue la [documentación de iOS](https://developer.apple.com/documentation/xcode/supporting-associated-domains) y la [documentación de Android](https://developer.android.com/identity/sign-in/credential-manager#add-support-dal).

</Callout>


```typescript
import { inAppWallet, hasStoredPasskey } from "thirdweb/wallets/in-app";

const { connect } = useConnect();

const handleLogin = async () => {
	await connect(async () => {
		const wallet = inAppWallet({
			auth: {
				passkeyDomain: "example.com", // defaults to current url
			},
		});
		const hasPasskey = await hasStoredPasskey(client);
		await wallet.connect({
			client,
			strategy: "passkey",
			type: hasPasskey ? "sign-in" : "sign-up",
		});
		return wallet;
	});
};
```

### Autenticarse con una billetera externa

También puedes usar billeteras como un método de autenticación. Al usar este método, tanto las billeteras externas como las billeteras dentro de la aplicación se conectan, y puedes alternar entre las dos en cualquier momento.

```typescript
import { inAppWallet } from "thirdweb/wallets/in-app";
import { sepolia } from "thirdweb/chains";

const { connect } = useConnect();

const handleLogin = async () => {
	await connect(async () => {
		const wallet = inAppWallet();
		await wallet.connect({
			client,
			strategy: "wallet",
			wallet: createWallet("io.metamask"), // or any other wallet
			chain: sepolia, // required for SIWE
		});
		return wallet;
	});
};
```

### Autenticarse como invitado

También puedes crear billeteras para tus usuarios sin necesidad de ninguna entrada. Esto creará una sesión que luego se podrá actualizar vinculando otra identidad. Ideal para una incorporación progresiva.

```typescript
import { inAppWallet } from "thirdweb/wallets/in-app";

const { connect } = useConnect();

const handleLogin = async () => {
	await connect(async () => {
		const wallet = inAppWallet();
		await wallet.connect({
			client,
			strategy: "guest",
		});
		return wallet;
	});
};
```


## Usa tu propia autenticación

Desde la configuración de la billetera en la aplicación en el panel de control de thirdweb, puedes habilitar [autenticación personalizada con tu propio JWT o endpoint de autenticación](/connect/in-app-wallet/custom-auth/configuration)

### JWT compatible con OICD

Pasa cualquier JWT compatible con OICD, que se puede usar con firebase, auth0 y más.

```typescript
import { inAppWallet } from "thirdweb/wallets/in-app";

const { connect } = useConnect();

const handleLogin = async () => {
	await connect(async () => {
		const wallet = inAppWallet();
		await wallet.connect({
			client,
			strategy: "jwt",
			jwt: "your-jwt"
		});
		return wallet;
	});
};
```

### Endpoint de autenticación personalizado

Endpoint de autenticación completamente personalizado, pasa tu propio payload y configura tu endpoint de verificación de autenticación en el panel de control de thirdweb. Este enfoque te permite usar prácticamente cualquier método de autenticación que se te ocurra.

```typescript
import { inAppWallet } from "thirdweb/wallets/in-app";

const { connect } = useConnect();

const handleLogin = async () => {
	await connect(async () => {
		const wallet = inAppWallet();
		await wallet.connect({
			client,
			strategy: "auth_endpoint",
			payload: "your-auth-payload"
		});
		return wallet;
	});
};
```



