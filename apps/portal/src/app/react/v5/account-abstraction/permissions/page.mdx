import { Tabs, TabsList, TabsTrigger, TabsContent } from "@/components/ui/tabs";
import { createMetadata, Stack, ArticleIconCard } from "@doc";
import { TypeScriptIcon } from "@/icons";

export const metadata = createMetadata({
	image: {
		title: "Permisos y Claves de Sesión",
		icon: "thirdweb",
	},
	title: "Permisos de Cuenta y Claves de Sesión | thirdweb",
	description:
		"Todos los contratos de cuenta - Simple y Administrada - comparten el mismo modelo de permisos. En esta sección, describiremos este modelo en detalle.",
});

# Permisos de Cuenta y Claves de Sesión

Una [cuenta inteligente](/react/v5/account-abstraction/get-started) puede tener dos tipos de actores: _Claves de Sesión_ y _Administradores_.

## Administradores

Los administradores tienen **acceso sin restricciones** a la cuenta; pueden llamar a cualquier función en el contrato, usar el contrato sin pasar por la infraestructura de ERC-4337 (bundlers, EntryPoint, etc.), retirar el saldo de tokens nativos de la cuenta, entre otras acciones.

### Asignación de Permisos de Administrador

Los administradores existentes en la cuenta pueden agregar nuevos administradores, eliminar administradores existentes o renunciar a su estado de administrador.

```tsx
import { addAdmin } from "thirdweb/extensions/erc4337";
import { useSendTransaction, useActiveAccount } from "thirdweb/react";
import { getContract } from "thirdweb";

const { mutate: sendTransaction } = useSendTransaction();
const smartAccount = useActiveAccount();

const onClick = () => {
	if (!smartAccount) return;
	const transaction = addAdmin({
		contract: getContract({
			address: smartAccount.address,
			chain,
			client,
		}),
		account: smartAccount,
		adminAddress: "0x...", // the address of the new admin
	});
	sendTransaction(transaction);
};
```

Consulta la función [Referencia de la API](/references/typescript/v5/erc4337/addAdmin) para más información.

<Stack>

<ArticleIconCard
	title="addAdmin"
	icon={TypeScriptIcon}
	href="/references/typescript/v5/erc4337/addAdmin"
	description="Función para agregar un nuevo administrador a la cuenta"
/>

<ArticleIconCard
	title="getAllAdmins"
	icon={TypeScriptIcon}
	href="/references/typescript/v5/erc4337/getAllAdmins"
	description="Función para obtener todos los administradores de la cuenta"
/>

<ArticleIconCard
	title="removeAdmin"
	icon={TypeScriptIcon}
	href="/references/typescript/v5/erc4337/removeAdmin"
	description="Función para eliminar un administrador de la cuenta"
/>
</Stack>

## Claves de Sesión

Las claves de sesión son firmantes adicionales autorizados que deben pasar por la infraestructura de ERC-4337 (bundlers, EntryPoint, etc.) para usar una cuenta y ejecutar transacciones. Las claves de sesión pueden utilizar una cuenta bajo ciertas restricciones.

### Asignación de Permisos a las Claves de Sesión

Cada clave de sesión individual tiene sus propios permisos para usar la cuenta. Solo los administradores pueden establecer los permisos para las claves de sesión.

Las claves de sesión pueden asignarse con los siguientes permisos:

- [Obligatorio] Permitir la interacción con contratos específicos usando la cuenta ("*" para cualquier contrato).
- [Opcional] Definir un monto máximo de tokens nativos que se pueden transferir por transacción (por defecto es 0 ETH, por lo que las transacciones con valor serán rechazadas).
- [Opcional] Restringir el acceso a la cuenta a un período de tiempo específico (por defecto es 10 años a partir de ahora).

```tsx
import { addSessionKey } from "thirdweb/extensions/erc4337";
import { useSendTransaction, useActiveAccount } from "thirdweb/react";
import { getContract } from "thirdweb";

const { mutate: sendTransaction } = useSendTransaction();
const smartAccount = useActiveAccount();

const onClick = () => {
	if (!smartAccount) return;
	const transaction = addSessionKey({
		contract: getContract({
			address: smartAccount.address,
			chain,
			client,
		}),
		account: smartAccount,
		sessionKeyAddress: "0x...", // la dirección de la nueva clave de sesión
		permissions: {
			approvedTargets: "*", // las direcciones de los contratos permitidos, o '*' para cualquier contrato
			nativeTokenLimitPerTransaction: 0.1, // la cantidad máxima de tokens nativos (en ETH) que la clave de sesión puede gastar por transacción
			permissionStartTimestamp: new Date(), // la fecha en que la clave de sesión se activa
			permissionEndTimestamp: new Date(Date.now() + 24 * 60 * 60 * 1000), // la fecha en que la clave de sesión expira
		},
	});
	sendTransaction(transaction);
};
```

Consulta la [Referencia de la API](/references/typescript/v5/erc4337/addSessionKey) para más información.

<Stack>

<ArticleIconCard
	title="addSessionKey"
	icon={TypeScriptIcon}
	href="/references/typescript/v5/erc4337/addSessionKey"
	description="Función para agregar una nueva clave de sesión a la cuenta"
/>

<ArticleIconCard
	title="getAllActiveSigners"
	icon={TypeScriptIcon}
	href="/references/typescript/v5/erc4337/getAllActiveSigners"
	description="Función para obtener todas las claves de sesión de la cuenta"
/>

<ArticleIconCard
	title="getPermissionsForSigner"
	icon={TypeScriptIcon}
	href="/references/typescript/v5/erc4337/getPermissionsForSigner"
	description="Función para obtener los permisos asignados a una clave de sesión"
/>

<ArticleIconCard
	title="removeSessionKey"
	icon={TypeScriptIcon}
	href="/references/typescript/v5/erc4337/removeSessionKey"
	description="Función para eliminar una clave de sesión de la cuenta"
/>
</Stack>

